# Netlify Configuration File
# This file configures how Netlify builds and deploys your Fusion project

[build]
command = "npm run build"
publish = "dist"
functions = "netlify/functions"

[dev]
targetPort = 8080

[build.environment]
NODE_VERSION = "22"
SECRETS_SCAN_OMIT_KEYS = "VITE_SUPABASE_URL,VITE_SUPABASE_ANON_KEY"

# Note: Environment variables should be set in Netlify dashboard, not here
# Go to: Site Settings → Build & Deploy → Environment → Edit Variables
# Add these variables:
# VITE_SUPABASE_URL = your_supabase_url
# VITE_SUPABASE_ANON_KEY = your_supabase_anon_key
# RESEND_API_KEY = your_resend_api_key (server-side only)

# Redirects are handled by public/_redirects file

# Cache headers for assets
[[headers]]
for = "/assets/*"
[headers.values]
Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
for = "/"
[headers.values]
Cache-Control = "public, max-age=3600, must-revalidate"

# Development context (for preview deployments)
[context.develop]
command = "npm run dev"

# Deploy preview context
[context.deploy-preview]
environment = { NODE_VERSION = "22" }

# Scheduled function for monthly updates
[functions."send-updates"]
schedule = "0 15 1 * *"

# Scheduled function for New Year email - runs at 00:00 UTC on January 1st
[functions."send-newyear"]
schedule = "0 0 1 1 *"
